<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Profile page</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-aFq/bzH65dt+w6FI2ooMVUpc+21e0SRygnTpmBvdBgSdnuTN7QbdgL+OapgHtvPp" crossorigin="anonymous">

  <!-- <link rel="stylesheet" href="./mvp.css" /> -->
  <style>
    body{
        margin-top:20px;
        color: #1a202c;
        text-align: left;
        background-color: #e2e8f0;    
    }
    .main-body {
        padding: 15px;
    }
    .card {
        box-shadow: 0 1px 3px 0 rgba(0,0,0,.1), 0 1px 2px 0 rgba(0,0,0,.06);
    }

    .card {
        position: relative;
        display: flex;
        flex-direction: column;
        min-width: 0;
        word-wrap: break-word;
        background-color: #fff;
        background-clip: border-box;
        border: 0 solid rgba(0,0,0,.125);
        border-radius: .25rem;
    }

    .card-body {
        flex: 1 1 auto;
        min-height: 1px;
        padding: 1rem;
    }

    .gutters-sm {
        margin-right: -8px;
        margin-left: -8px;
    }

    .gutters-sm>.col, .gutters-sm>[class*=col-] {
        padding-right: 8px;
        padding-left: 8px;
    }
    .mb-3, .my-3 {
        margin-bottom: 1rem!important;
    }

    .bg-gray-300 {
        background-color: #e2e8f0;
    }
    .h-100 {
        height: 100%!important;
    }
    .shadow-none {
        box-shadow: none!important;
    }
  </style>
</head>
<body>
   <main> 
    <div class="container">
      <div class="main-body">
      
            <!-- Breadcrumb -->
            <!-- <nav aria-label="breadcrumb" class="main-breadcrumb">
              <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="index.html">Home</a></li>
                <li class="breadcrumb-item"><a href="javascript:void(0)">User</a></li>
                <li class="breadcrumb-item active" aria-current="page">User Profile</li>
              </ol>
            </nav> -->
            <!-- <nav aria-label="breadcrumb" class="main-breadcrumb" style="text-align: right;">
              <ol class="breadcrumb">
                <li class="text-danger"><a href="/sessionLogout">Logout</a></li>
              </ol>
            </nav> -->
            <!-- /Breadcrumb -->
      
            <div class="row gutters-sm">
              <div class="col-md-2"></div>
              <div class="col-md-8">
                <form id="user_edit">
                    <input type="hidden" name="uid" value="<%= user.uid %>">
                    <input type="hidden" name="lastname" value="<%= userData.lastname %>">
                    <input type="hidden" name="email" value="<%= user.email %>">
                    <div class="card mb-3">
                    <div class="card-body">
                        <div class="row">
                            <div class="col-sm-3">
                            <h6 class="mb-0">Last Name</h6>
                            </div>
                            <div class="col-sm-9 text-secondary">
                                <%= userData.lastname %>
                                <p class="text-danger mb-0" style="font-size: 10px;;" >You can't chnage last name</p>
                            </div>
                        </div>
                        <hr>
                        <div class="row">
                            <div class="col-sm-3">
                            <h6 class="mb-0">Email</h6>
                            </div>
                            <div class="col-sm-9 text-secondary">
                            <%= user.email %>
                            <p class="text-danger mb-0" style="font-size: 10px;;" >You can't chnage email address</p>
                            </div>
                        </div>
                        <hr>
                        <div class="row">
                        <div class="col-sm-3">
                            <h6 class="mb-0">First Name</h6>
                        </div>
                        <div class="col-sm-9 text-secondary">
                            <input type="text" id="form3Example31" class="form-control form-control-sm"
                            placeholder="First Name" name="name" value="<%= userData.name %>" />
                            
                        </div>
                        </div>
                        <hr>
                        
                        <div class="row">
                        <div class="col-sm-3">
                            <h6 class="mb-0">Phone</h6>
                        </div>
                        <div class="col-sm-9 text-secondary">
                            (348) 816-9029
                        </div>
                        </div>
                        <hr>
                        <div class="row">
                        <div class="col-sm-3">
                            <h6 class="mb-0">Mobile</h6>
                        </div>
                        <div class="col-sm-9 text-secondary">
                            (320) 380-4539
                        </div>
                        </div>
                        <hr>
                        <div class="row">
                        <div class="col-sm-3">
                            <h6 class="mb-0">Address</h6>
                        </div>
                        <div class="col-sm-9 text-secondary">
                            Bay Area, San Francisco, CA
                        </div>
                        </div>
                        <hr>
                        <div class="row">
                        <div class="col-sm-12" style="text-align: right;">
                            <a class="btn btn-light " href="/">Back to Profile</a>
                            <input  type="submit" class="btn btn-info" value="Update">
                        </div>
                        </div>
                    </div>
                    </div>
                </form>
              </div>
            </div>
  
          </div>
      </div>
      <script src="https://www.gstatic.com/firebasejs/7.14.1/firebase-app.js"></script>
      <script src="https://www.gstatic.com/firebasejs/7.14.1/firebase-auth.js"></script>
      <script src="https://www.gstatic.com/firebasejs/7.14.1/firebase-firestore.js"></script>
      <script src="https://www.gstatic.com/firebasejs/7.14.1/firebase-analytics.js"></script>
      <script src="https://cdn.jsdelivr.net/npm/js-cookie@rc/dist/js.cookie.min.js"></script>
      <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha2/dist/js/bootstrap.bundle.min.js" integrity="sha384-qKXV1j0HvMUeCBQ+QVp7JcfGl760yU08IQ+GpUo5hlbpg51QRiuqHAJz8+BrxE/N" crossorigin="anonymous"></script>
      <script>
        const firebaseConfig = {
          apiKey: "AIzaSyAwUQlCm_2b1-fOqP3npYjn8uyVw61Q3mo",
          authDomain: "nodetask-3f111.firebaseapp.com",
          projectId: "nodetask-3f111",
          storageBucket: "nodetask-3f111.appspot.com",
          messagingSenderId: "802820142672",
          appId: "1:802820142672:web:61c52ee6b7f44f262c4355",
          measurementId: "G-YJRZKRMYG0"

        };
        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);

        firebase.auth().setPersistence(firebase.auth.Auth.Persistence.NONE);
        db = firebase.firestore();
            document
                .getElementById("user_edit")
                .addEventListener("submit", (event) => {
                    event.preventDefault();
                    
                    const uid = event.target.uid.value;
                    const name = event.target.name.value;
                    const lastname = event.target.lastname.value;
                    const email = event.target.email.value;

                    const data = {
                        'uid':uid,
                        'name':name,
                        'lastname':lastname,
                        'email':email
                    }

                    db.collection('UsersData').doc(uid).update(data)
                    .then(() => {
                        window.location.assign("/");
                    }); 
                    return false;
                });

      </script>
   </main>
</body>
</html>